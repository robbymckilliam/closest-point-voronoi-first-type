\documentclass[a4paper,10pt]{article}
%\documentclass[draftcls, onecolumn, 11pt]{IEEEtran}
%\documentclass[journal]{IEEEtran}
 
\usepackage{../mathbf-abbrevs}
\input{../defs}

\usepackage{zref-xr,zref-user}
\zexternaldocument*{../paper}

\usepackage[left=2cm,right=2cm,top=2cm,bottom=2cm]{geometry}

\usepackage{amsmath,amsfonts,amssymb, amsthm, bm}

%\usepackage[square,comma,numbers,sort&compress]{natbib}

\usepackage{color}
\newcommand{\comment}[1]{\textcolor{red}{#1}}

\newcommand{\sgn}{\operatorname{sgn}}
\newcommand{\sinc}{\operatorname{sinc}}
\newcommand{\rect}[1]{\operatorname{rect}\left(#1\right)}

%opening
\title{Finding a closest point in a lattice of Voronoi's first kind}
\author{Robby~G.~McKilliam, Alex Grant and I. Vaughan L. Clarkson
%\thanks{}
}

\renewcommand{\theenumii}{(\alph{enumii})}
\renewcommand{\labelenumii}{\theenumii}

\begin{document}

\maketitle

We thank both reviwers for their thoughtful comments.  %The authors feel the paper has improved as a result.


\section*{Reviewer 1}\label{sec:reviewer-1}

\begin{itemize}

\item\textbf{Comment:} 
From the perspective of quadratic forms, the quadratic forms induced by obtuse superbases are in one to one correspondance with graph Laplacians (this is not
explicitly stated in the paper for some reason). Indeed, the quadratic form $\|B\xbf\|^2$ is exactly $\xbf^T L_G \xbf$, where $L_G$ is the Laplacian the weighted graph $G$ on vertices $\{ 1, . . . , n + 1 \}$ , with edges weights $w_{ij} = -\bbf_i \cdot \bbf_j \geq 0, i = j$ (which they call the Selling parameters). More precisely:
\[
\|B\xbf\|_2^2 = \xbf^T L_G \xbf = \sum_{ \{i,j\} \in E[G] } w_{ij} (\xbf_{i} - \xbf_{j} )^2.
\]
\\ \textbf{Response:}

\item\textbf{Comment:} 
BLERG: NEED TO CHECK REFS MATHS ETC To present the result from the perspective of Computational Complexity (also not given in the
paper), this paper can be viewed as giving a polynomial time algorithm for the Closest Vector
Problem with Preprocessing (CVPP) over a special class of lattices. In the preprocessing model,
we are allowed to compute any polynomial amount of advice about the lattice (i.e. a good basis, or many short vectors in the lattice, etc.) before answering any CVP queries, where the resources needed to compute this advice are not counted in the runtime of the algorithm. In its
gap decisional version, where we need only decide whether a target is at distance $\leq d$ or $> \alpha d$
(for some approximation factor $\alpha \geq 1$), it is was shown [1, 4] to be NP-Hard for any constant $\alpha = 2^{\log^{1-\epsilon}n}$, and to not be polynomial time solvable for $\alpha = 2 \log n$ , for any fixed $\epsilon > 0$, under the assumption  that $NP \subsetneq \text{RTIME}(2^{\log^{O(1/\epsilon)}n})$ (quasi-polynomial time). For its approximate search version (i.e. find a lattice vector whose distance to the target is some bounded factor away from optimal), an $O(n^{1.5})$ approximation algorithm was (implicitly) given in [5], which was only recently improved to $O( \sqrt{ n / \log n} )$ in [3].
\\\textbf{Response:}

\item\textbf{Comment:} 
BLERG CHECK REFS Hence, from the standpoint of CVPP, the algorithm in this paper gives essentially the first
exact polynomial time algorithm over a reasonably large and natural class of lattices, i.e. those
of Voronoi’s first kind. Lastly, removing the need for preprocessing for these lattices, at least for
solving SVP without being given an obtuse superbasis, would require a substantial breakthrough
in the theory of lattice problems (not stated in paper). Indeed, by a simple reduction this would
allow us to decide whether a lattice (given any of its bases) is a rotation of $\ints^n$ (which is clearly
of Voronoi’s first kind). This is a long standing open problem in the theory of lattices, which has
only recently been solved in certain very special cases~\cite{Lenstra_Silverberg_revisting_gentra_szydlo_2014}.
\\\textbf{Response:}
The final paragraph of Section~\zref{sec:discussion} has been modified to included that the correction with the existing problem of determining a rectangular basis should it exist.

``A final remark is that our algorithm assumes that the obtuse superbasis is known in advance.  It is known that all lattices of dimension less than or equal to 3 are of Voronoi's first kind and an algorithm exists to recover the obtuse superbasis in this case~\cite{SPLAG}.  Lattices of dimension larger than 3 need not be of Voronoi's first kind.  An interesting question is: given a lattice, is it possible to efficiently decide whether it is of Voronoi's first kind?  A related question is: is it possible to efficiently find a obtuse superbasis if it exists?  It is suspected that the answer to both of these questions is no.  An efficient solution to either question would immediately yield a solution to a known problem, that of determining whether a lattice is rectangular (has a basis consisting of pairwise orthogonal vectors) given an arbitrary basis~\cite{Lenstra_Silverberg_revisting_gentra_szydlo_2014}.''


\item\textbf{Comment:} 
This paper makes a solid contribution to the theory of lattice problems. I think the results here are
well-motivated (I encourage the authors to include some of the motivation mentioned in the summary), and point to the possibility that there might be large and useful classes of lattices where
solving CVP is “easy”.
\\\textbf{Response:}
The following paragraph has been added to Section~\zref{sec:discussion} to suggest that similar fast algorithms for other classes of lattices might exist:

``Another interesting question is: are there subfamilies of Voronoi's first kind that admit even faster algorithms?  Both $A_n$ and $A_n^*$ are examples of this, but there might exist other subfamilies with algorithms faster than $O(n^4)$.  A related question is: can the techniques developed in this paper be applied to other families of lattices, i.e., beyond just those of Voronoi's first kind?''


\item\textbf{Comment:} 
On a technical level, I found the main convergence proof to be interesting, as I’ve rarely seen
combinatorial arguments successfully applied to lattice problems. On the other hand, while I’ve
convinced myself the authors have the ``right'' convergence proof, I found its presentation to be
rather awkward and unintuitive. I highly recommend that the authors rephrase the proof using
the language of Laplacians, which would make things more clear (see the additional comments
below for some technical suggestions).
\\\textbf{Response:}

\end{itemize}

We now respond to the reviewers numbered comments.

\begin{enumerate}

\item\textbf{Comment:} 
BLERG REFS.  I believe Proposition 2.1 and 2.2 appear essentially verbatim in [8]. Same for Propositions
3.1 (which is essentially by definition) and 3.2, they appear in [9]. I don’t think it adds any
readibility/anything of value to reprove them here.
\\\textbf{Response:}

\newcommand{\rng}{\operatorname{rng}}
\newcommand{\subrng}{\operatorname{subr}}
\newcommand{\decrng}{\operatorname{decrng}}

\item\textbf{Comment:} 
Almost all the inequalities in the paper can be derived from the following simple obser-
vation.  For and $n$ vertex weighted graph $G$ with non-negative edge weights, and vectors, $\xbf,\ybf \in \reals^n$, if there exists a permutation $\pi$ of $[n]$ such that $\xbf_{\pi[1]} \leq \dots \leq \xbf_{\pi[n]}$ and $\ybf_{\pi[1]} \leq \dots \leq \ybf_{\pi[n]}$ then
\[
\xbf^T L_G \ybf = \sum_{ \{i,j\} \in E[G] } \wbf_{ij} (\xbf_{i} - \xbf_{j}) (\ybf_{i} - \ybf_{j}) \geq 0.
\]
Furthermore, if $\xbf_{\pi[1]} \leq \dots \leq \xbf_{\pi[n]}$ and $\ybf_{\pi[1]} \geq \dots \geq \ybf_{\pi[n]}$ then the above inequality if reversed, i.e $\xbf^T L_G \ybf \leq 0$. 

I believe using the above will make many of your proofs more transparent.  For example, if you redefine $\subrng(\xbf)$ to return the largest set $S$ such that $\min_{i\in S} \xbf_i - \max_{j \notin S} \xbf_j \geq 1$, then noice that if $S \neq \emptyset$ then there is a permutation that puts both $\xbf - 1_S$ and $1_S$ in non-decreasing order. In particular this implies that
\[
\xbf L_G \xbf = (\xbf - 1_S)^T L_G (\xbf - 1_S) + 2(\xbf - 1_S)^T L_G 1_S + 1_S^T L_G 1_S \geq (\xbf - 1_S)^T L_G (\xbf - 1_S),
\]
i.e. $\xbf$ can be made ``shorter'' by squeezing its components closer together.

Furthermore, one can use this to give a two line proof of Theorem 4.1.  This theorem I actually do think make sense to reprove here, because modifications of this proof are what drives the convergence bound. 
\\\textbf{Response:}
BLERG.  I think there's an error in the inquality above.

\item\textbf{Comment:} 
Lemma 5.1: there is a typo here.  The last identity should read
\[
\|B\pbf\|^2 - \|B(\pbf + 1_S - 1_T)\|^2 = \Phi(S,\pbf) + \Phi(\bar{T}, \pbf) + 2\sum_{i \in S}\sum_{j\in S} q_{ij}.
\]
Notice that factor 2 in front of the last term.  There are also two related typos on the top of page 12 where $\sum_{i \in S}\sum_{j\in S} q_{ij}$ (this appears twice on difference lines) should be $2\sum_{i \in S}\sum_{j\in T} q_{ij}$.
\\\textbf{Response:}
This error has been fixed.


\item\textbf{Comment:} 
Lemma 5.7: $h$ is ill-defined if $\rng(\vbf) = 0$.  You should explicitly state that $\rng(\vbf) \geq 1$.
\\\textbf{Response:}
Fixed.


\end{enumerate}


\section*{Reviewer 2}\label{sec:reviewer-2}

\begin{enumerate}
\item\textbf{Comment:}  
page 1, last line "The closest lattice point problem is known to be NP-hard under certain condition ...": I found this paragraph very confusing, and somehow inaccurate. What "certain conditions"? I think a better way to describe the sitation regaring the NP-hardness of CVP in relation to this paper is the following. CVP is known to be NP-hard even to approximate within almost polynomial factor (see 35) when the lattice is arbitrary and not known in advance. Interestingly (see 35 and 17) there are families of lattices when CVP remain NP-hard even when given the best possible basis (or any hard-to-compute side information about the lattice). This version of the problem is called CVP with preprocessing (CVPP), and it is particularly relevant to this work, where it is shown that CVPP can be solved exactly and in polynomial time for the class of lattices of Voronoi first kind, when given as auxiliary information a special basis (namely, an obtuse superbasis.) 
\\\textbf{Response:}

\item\textbf{Comment:}  
Additional comments about the above paragraph: one author is missing in the reference for 12. Of [1,23,40] only 23 achieves $n^{O(n)}$ running time. (I think the algorithms in 40 take $2^{O(n^2)}$.) There is a journal version of 37 in SIAM J. Computing, and the paper is by two authors (not just Micciancio). 
\\\textbf{Response:}

\item\textbf{Comment:}  
page 2, second paragraph: Aren't the results of 3,29 and 30 subsumed by 34? (The authors sure know better than me. A a short clarification may direct the interested reader to the best paper to read.) Also, CVP is always solvable in polynomial time when the dimension is fixed. So, it is unclear the significance of CVP algorithms for Leech lattice (in fixed dimension 24) in the context of this discussion. 
\\\textbf{Response:}
This sentence has been reworded and the reference list has been reduced.  It now reads:

``Although the problem is NP-hard in general, fast algorithms are known for specific highly regular lattices, such the integer lattice $\ints^{n}$, the root lattices $A_n$ and $D_n$, their dual lattices $A_n^*$ and $D_n^*$, and the related Coxeter lattices~\cite[Chap.~4]{SPLAG}\cite{Conway1982FastQuantDec, McKilliam2008, McKilliam2009CoxeterLattices}.''

The interested reader could read these references in the order given. %, i.e., first Chapter 4 of~\cite{SPLAG} and~\cite{Conway1982FastQuantDec} for $D_n$ and $D_n^*$ and older algorithms for $A_n$ and $A_n^*$.  Then~\cite{McKilliam2008} for a fast algorithm for $A_n^*$, then~\cite{McKilliam2009CoxeterLattices} for fast algorithms for all of the Coxeter lattices that includes $A_n$ and $A_n^*$, $E_8$, etc.  Technically, the algorithm from~\cite{McKilliam2009CoxeterLattices} does include that from~\cite{McKilliam2008}.  However~\cite{McKilliam2008} is simpler and shorter to read first.

\item\textbf{Comment:}  
When saying ``if the obtuse superbasis is known'', you may want to cast this requirement in the context of CVPP. (The obtuse superbasis is the advice provided by the preprocessing.) 
\\\textbf{Response:}

\item\textbf{Comment:}  
page 2,bottom, displayed equation "$v \cdot x \leq x \cdot x$". Maybe you mean strict inequality.
\\\textbf{Response:}
Our definition includes what Conway and Sloane call the `lax' relevant vectors.  To make this clear the following sentences have been added below the definition of the relevant vectors in Section~\zref{sec:voron-cells-relev}:

``This definition includes what Conway and Sloane call the `lax' relevant vectors~\cite{ConwaySloane1992_voronoi_lattice_3d_obtuse_superbases}.  If the definition above is replaced by one with strict inequality then only the `strict' relevant vectors would be considered. It will be of benefit to include all of the strict and lax relevant vectors here.''

\item\textbf{Comment:}  
page 3, and maybe elsewhere "short vector in a lattice" should probably be "shortest nonzero vector in a lattice". 
\\\textbf{Response:}
We have instead introduced the term `short vector' in the introduction.  The following sentence is included in the first paragraph of the introduction: ``This is called the \emph{shortest vector problem} and a solution is called a~\emph{short vector}.''

\item\textbf{Comment:}  
page 3, definition of ceiling(r) as smallest integer strctly larger than 3 seems unconventional. The standard definition is not strict. Write floor(r)+1 instead, which is consistent with the definition of floor(r) given later in the paper. 
\\\textbf{Response:}
Done.

\item\textbf{Comment:}  
page 3, proof of Prop. 2.1. Your definition of ``half-open voronoi cell'' is not a proper definition, and also seems incorrect. E.g., take the integer lattice $\ints^n$, then only one of the corners (rather than half) of the corners of the Voronoi cell should be included if you want a tiling. 
\\\textbf{Response:}
The reviewer is correct.  We only require that some modification of the boundary of the closed Voronoi cell results in a tiling.  The proof of Proposition~\zref{eq:latticepointsinvorcvell} has been modified accordingly.

\item\textbf{Comment:}  
page 3, prop 2.2, again definition of ceiling(r) is non-standard. Use floor(r)+1 instead. 
\\\textbf{Response:}
Done. 

\item\textbf{Comment:}  
page 3, section 3. 
The process described in (3.1) is almost identical to those in [45,37], so those papers should probably be referenced at the very beginning, and a comparison provided. As far as I remember, the difference is that 37 picks the v that minimizes the voronoi norm (i.e., the norm defined by the voronoi cell of the origin) instead of the euclidean norm. On the other hand, 45 uses the euclidean norm, but selects an arbitrary relevant vector that reduces the euclidean norm, rather than the one that reduces it the most. In this respect, your process is a special case of the one described in 45, and termination (your propositions 3.1 and 3.2) is already proved in 45. 
\\\textbf{Response:}
We have included the following text in the first paragraph of Section~\zref{sec:iterative-slicer} when introducing the interative algorithm.

``Motivated by Shalvi~et.~al.~\cite{Shalvi_iterativeslicer_2009} and  Micciancio and Voulgaris~\cite{MicciancioVoulgaris_deterministic_jv_2013}, we consider the following iteration,''

Among the iterative proceedures in this paper, in~\cite{Shalvi_iterativeslicer_2009}, and in~\cite{MicciancioVoulgaris_deterministic_jv_2013}, ours is the simplest.  The choice of our iteration is not motivated by what might be fastest in general lattices.  It is motivated by what we can prove to be polynomial time for those lattices of Vornoi's first kind.

The~\emph{iterative slicer}~\cite{Shalvi_iterativeslicer_2009} is similar but uses the (presumably accelerated?) iteration
\begin{align}
x_{k+1} &= x_k + \alpha_k v_k \nonumber \\
(v_k, \alpha_k) &= \arg\min_{ v \in \relevant(\Lambda) \cup \{\zerobf\}, \alpha \in \ints } \|y - x_k - \alpha v \|.
\end{align} 
So it allows adding integer multiples of a relevant vector.  We do not believe using this will improve the complexity of our algorithm beyond $O(n^4)$.  It would greatly complicate our proofs.

The iterative algorithm of Micciancio and Voulgaris~\cite{MicciancioVoulgaris_deterministic_jv_2013} is quite different altogther.  As we understand it, is not to add relevant vectors, but to instead scale the lattice 

We have not included a description of the iterative approaches using in 

\item\textbf{Comment:}  
page 5, as before, you should probably mention also Voulgaris when citing 37. 
\\\textbf{Response:}
Done.

\item\textbf{Comment:}  
page 5, last line, "dimension less than 4", does it include 4 or not? 
\\\textbf{Response:}
It does not include 4.  We have modified the text here to read ``less than or equal to $3$''. We have also modified similar text in the last paragraph of Section~\zref{sec:discussion} to read ``It is known that all lattices of dimension less than or equal to 3 are of Voronoi's first kind and an algorithm exists to recover the obtuse superbasis in this case~\cite{SPLAG}.  Lattices of dimension larger than 3 need not be of Voronoi's first kind.''

\item\textbf{Comment:}  
page 5, as before, you should probably mention also Voulgaris when citing 37. 
\\\textbf{Response:}
Done.

\item\textbf{Comment:}  
page 6, Theorem 4.1 (this follows from [ 9, Theorem 2+3], not just theorem 3. 
Also, make the theorem statement self contained by adding "Let L be a lattice of voronoi first kind with obtuse superbasis b1..bn+1". 
\\\textbf{Response:}

\item\textbf{Comment:}  
page 8, lemma 5.1. I think you forgot a factor 2 preceding the double summations over S and T (at end of lemma statement, and also in the proof.) 
\\\textbf{Response:}
This error has been fixed.

\item\textbf{Comment:}  
page 11, "with be" $\to$ "will be" Displayed equation before "Putting p=...", A | should be || (5.7) again, missing factor 2 before double summation, and second set should be T, not S. 
\\\textbf{Response:}
These errors have been fixed.

\item\textbf{Comment:}  
page 12, first displayed equation, usual problem: missing factor 2, and summation over S\&S instead of S\&T both on line 2 and 3. 
\\\textbf{Response:}
These errors have been fixed.

\item\textbf{Comment:}  
page 12, last line, definition of $s_i$, missing (-2) factor. 
\\\textbf{Response:}
This error has been fixed.

\item\textbf{Comment:}  
page 13, after (6.1), "be computing" $\to$ "by computing" 
\\\textbf{Response:}
Fixed.

\item\textbf{Comment:}  
page 14, "have no effect" $\to$ "has no effect" 
\\\textbf{Response:}
Fixed.

\item\textbf{Comment:}  
page 15, definition of $Q$, should the summation defining $q_{ii}$ be restricted to $j\neq i$? 
\\\textbf{Response:}
Yes. This has been fixed.

\item\textbf{Comment:}  
page 15, "there many" $\to$ "there may" 
\\\textbf{Response:}
Fixed.

\item\textbf{Comment:}  
References: 
- 12: missing author (R. Raz) 
- 18: "A V" -> "A. V." etc, 
- 37: journal version in SIAM J. computing, 42(3):1364-1391 (2013) 
\\\textbf{Response:}
Fixed.

\item\textbf{Comment:}  
Some additional references on CVPP you may find interesting 
(cite at your own discretion): 

- O. Regev (2004) Improved Inapproximability of Lattice and Coding Problems With Preprocessing. IEEE Transactions on Information Theory 50(9): 2031-2037 
- "Hardness of Approximating the Closest Vector PRoblem with Pre-Processing", M. Alekhnovich, S. Khot, G. Kindler, N. Vishnoi, Computational Complexity 20(4):741-753, 2011. 

(Improve NP-hardness result of [35,17] to any constant approximation factor) 

- D. Aharonov and Oded Regev (2005). Lattice problems in NP ∩ co-NP. J. ACM 52, 749-765. 

(Gives polynomial time solution to approximate the distance estimation version of CVPP within $\gamma=\sqrt(n \log n)$ approximation factor, i.e., for any lattice there is an appropriate advice (more complex than just a good basis) that allows to approximate in polynomial time the distance of any target point to the lattice within gamma, but without actually finding a nearby lattice point.) 

- On the Closest Vector Problem with a Distance Guarantee 
D. Dadush, O. Regev, N. Stephens-Davidowitz, Computational Complexity Conference 2014, to appear (next week!) 

I am not sure, as the paper has not appeared yet, but I suspect it is the same as the paper on Dadush webpage with title "On BDD and CVPP". 
See link 
http://cs.nyu.edu/~dadush/papers/cvpp.pdf 
and read abstract for more information.
\\\textbf{Response:}

\end{enumerate}




\bibstyle{../siam}
\bibliography{../bib}

\end{document}





















